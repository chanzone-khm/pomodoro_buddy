# 🍅 ポモドーロバディ - タスク管理統合版

Chrome拡張機能のポモドーロタイマーにタスク管理機能を統合したMVP版

## 🌟 主要機能

### ✅ P0 (MVP) - 実装済み機能

1. **📋 カンバンタスク管理**
   - 3列レイアウト（Backlog/Doing/Done）
   - ドラッグ&ドロップによるタスク移動
   - タスクの作成・編集・削除

2. **🍅 ポモドーロスロット計画**
   - 1日最大6スロット（設定可能）
   - タスクをスロットに割り当て
   - 予想ポモドーロ数による複数スロット予約

3. **⏱️ 自動実績追跡**
   - ポモドーロ完了時の自動カウント
   - リアルタイム進捗表示
   - タスク完了の自動ステータス変更

4. **📊 統計とダッシュボード**
   - 日別完了数と達成率
   - タスク進捗の可視化

## 🚀 インストール・使用方法

### セットアップ
1. 依存関係のインストール
   ```bash
   npm install
   ```

2. ビルド
   ```bash
   npm run build
   ```

3. Chrome拡張機能として読み込み
   - Chrome > 拡張機能 > デベロッパーモード ON
   - 「パッケージ化されていない拡張機能を読み込む」
   - `dist`フォルダを選択

### 基本的な使い方

#### 1. タスク管理
1. ポップアップから「📋 カンバン」ボタンをクリック
2. 「新しいタスク」で作成
3. 予想ポモドーロ数を設定
4. カンバンボードでステータス管理

#### 2. ポモドーロ計画
1. タスクマネージャーでタスクをスロットにドラッグ&ドロップ
2. または空のスロットをクリックして選択
3. 複数ポモドーロのタスクは連続スロットを自動予約

#### 3. ポモドーロ実行
1. ポップアップでタイマー開始
2. 作業完了時に自動で実績を記録
3. タスクの進捗がリアルタイム更新

## 🧪 テスト手順

### 基本動作テスト
1. **タスク作成テスト**
   - [ ] 新しいタスクを作成できる
   - [ ] タスクに説明と予想ポモドーロ数を設定できる
   - [ ] タスクをBacklog→Doing→Doneに移動できる

2. **スロット割り当てテスト**
   - [ ] タスクをスロットにドラッグ&ドロップできる
   - [ ] 3ポモドーロのタスクが3つの連続スロットを占有する
   - [ ] スロットからタスクを削除できる

3. **ポモドーロ実行テスト**
   - [ ] タイマー開始・停止・リセットが動作する
   - [ ] 作業完了時にタスクの実績が+1される
   - [ ] 予定ポモドーロ数到達時にタスクが自動完了する

4. **統合テスト**
   - [ ] ポップアップとタスクマネージャー間でデータが同期される
   - [ ] ページリロード後もデータが保持される
   - [ ] 統計情報が正しく表示される

## 📁 ファイル構造

```
src/
├── components/           # UIコンポーネント
│   ├── KanbanBoard.ts   # カンバンボード
│   ├── PomodoroSlots.ts # スロット管理
│   ├── TaskManager.ts   # メインオーケストレーター
│   └── kanban.css       # スタイリング
├── popup/               # ポップアップUI
│   ├── popup.html       # メインポップアップ
│   ├── popup.ts         # ポップアップロジック
│   ├── task-manager.html # タスク管理画面
│   └── task-manager.ts  # タスク管理ロジック
├── utils/               # ユーティリティ
│   ├── storage.ts       # ストレージ操作
│   ├── tasks.ts         # タスク管理
│   └── timer.ts         # タイマー操作
├── types/               # 型定義
│   └── index.ts         # 全型定義
└── background.ts        # バックグラウンドスクリプト
```

## 🔧 開発コマンド

```bash
# 開発サーバー起動
npm run dev

# 型チェック
npm run type-check

# ビルド
npm run build

# テスト実行
npm test
```

## 📝 実装状況

- ✅ Story 1-1: 今日の🍅プラン枠を用意
- ✅ Story 1-2: タスクカードをバックログから選択／配置
- ✅ Story 1-3: タスクに必要な🍅数を予約
- ✅ Story 1-4: ポモドーロ完了でタスク実績を自動加算
- ✅ Story 1-5: カンバンで状態を俯瞰

## 🚧 今後の予定

### Sprint 2（次期リリース）
- リピートタスクの予約機能
- 詳細な統計とチャート機能
- スロット数・セッション長の柔軟な設定

### Sprint 3（将来機能）
- カンバン列のカスタマイズ
- プロジェクト別タスク管理
- データエクスポート機能

## 🐛 既知の問題
- デバッグモードでのタスク統合確認が必要
- 大量タスクでのパフォーマンス最適化
- カンバンボードのアクセシビリティ改善

## ✅ 修正済みの問題（v1.1）
- カンバンタスク追加時の無限ループバグを修正
- UIコンポーネント間の適切な更新制御を実装
- パフォーマンス改善とメモリリーク防止

## 🆕 v1.2の新機能・改善
- **カンバンからプラン追加**: タスクカードに「+」ボタン追加、ワンクリックでプラン追加
- **プラン状態の可視化**: プラン済みタスクの背景色変更と「📅 プラン済み」表示
- **プラン削除機能**: スロットの「✕」ボタンが確実に動作、適切な確認ダイアログ
- **スロット選択改善**: 番号入力の安定性向上、エラーハンドリング強化

## 🔧 v1.3の技術改善
- **ストレージ制限対応**: Chrome storage sync API制限エラーを解決
- **書き込み最適化**: デバウンス処理により不要な保存を削減
- **フォールバック機能**: sync失敗時のlocal storageバックアップ
- **エラーハンドリング**: ストレージエラーの適切な処理とログ

## 🤝 コントリビューション
プルリクエストとissueは歓迎です。[BACKLOG.md](./BACKLOG.md)で実装計画を確認してください。

# ポモドーロバディ (Pomodoro Buddy) v1.5

Chrome拡張機能としてタスク管理とポモドーロタイマーを統合したプロダクティビティツールです。

## v1.5での修正 ⚠️

### 🔧 修正された問題
1. **重複実行の修正**: スロット選択時の複数回実行を防止
2. **イベントリスナー改善**: 重複登録によるパフォーマンス問題を解決
3. **キャンセル処理改善**: より確実なキャンセル検出

### 🧪 テスト方法

#### 1. プラン追加ボタンのテスト
**注意**: 「新しいタスク」ボタンではなく、**タスクカード内の「+」ボタン**をクリックしてください！

1. Backlogにタスクが存在することを確認
2. タスクカードの右上にある **「+」ボタン** をクリック
3. コンソールで以下のようなログが出力されることを確認：
   ```
   Plan add button clicked
   Task ID from button: [タスクID]
   addTaskToPlan called with taskId: [タスクID]
   ```

#### 2. スロット選択のテスト
1. 空のスロットをクリック
2. 数字「1」を入力してOK
3. 同じログが複数回出力されないことを確認
4. 空入力でOKを押した場合、タスクが追加されないことを確認

#### 3. キャンセル操作のテスト
1. 空のスロットをクリック
2. キャンセルボタンをクリック
3. コンソールに「タスク選択がキャンセルされました（null）」が表示されることを確認

### 🔍 デバッグ情報
- コンソール（F12）でタスクの状態とボタンの表示状況を確認
- 各タスクについて「ステータス」「プラン済み」「進行中」の状態が表示されます
